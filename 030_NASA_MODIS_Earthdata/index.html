<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Prof P. Lewis">
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>NASA MODIS Earthdata - GEOG0111</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "NASA MODIS Earthdata";
    var mkdocs_page_input_path = "030_NASA_MODIS_Earthdata.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> GEOG0111</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Introduction</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Course Basics</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../001_Notebook_use/">Notebook Use</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../002_Unix/">Unix</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../003_Help/">Help</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../004_Accounts/">Accounts</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../005_Packages/">Packages</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Answers</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../001_Notebook_use_answers/">Notebook Use</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../002_Unix_answers/">Unix</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../003_Help_answers/">Help</a>
                </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Core Concepts</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../010_Python_Introduction/">Python Introduction</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../011_Python_data_types/">Python Data Types</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../012_Python_strings/">Python Strings</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../013_Python_string_methods/">Python String Methods</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../014_Python_groups/">Python Groups</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../015_Python_control/">Python Control</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../016_Python_for/">Python For</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../017_Functions/">Functions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../018_Running_Python/">Running Python</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Answers</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../010_Python_Introduction_answers/">Python Introduction</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../011_Python_data_types_answers/">Python Data Types</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../012_Python_strings_answers/">Python Strings</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../013_Python_string_methods_answers/">Python String Methods</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../014_Python_groups_answers/">Python Groups</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../015_Python_control_answers/">Python Control</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../016_Python_for_answers/">Python For</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../017_Functions_answers/">Functions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../018_Running_Python_answers/">Running Python</a>
                </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Data Basics</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../020_Python_files/">Python Files</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../021_Streams/">Streams</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../022_Read_write_files/">Read Write Files</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../023_Plotting/">Plotting</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../024_Image_display/">Image Display</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Answers</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../020_Python_files_answers/">Python Files</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../021_Streams_answers/">Streams</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../022_Read_write_files_answers/">Read Write Files</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../023_Plotting_answers/">Plotting</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../024_Image_display_answers/">Image Display</a>
                </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Array Data</span></p>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">NASA MODIS Earthdata</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#purpose">Purpose</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#prerequisites">Prerequisites</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#test">Test</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#modis-lai-product">MODIS LAI product</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#exercise-1">Exercise 1</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#accessing-nasa-modis-urls">Accessing NASA MODIS URLs</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#data-products">Data Products</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mota">MOTA</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#masking">masking</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#exercise-2-mask-invalid-data">Exercise 2: mask invalid data</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#burned-area-dataset-mcd64a1">Burned area dataset MCD64A1</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#exercise-3">Exercise 3</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#snow">Snow</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#land-cover-dataset-mcd12q1">Land Cover dataset MCD12Q1</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#exercise-5">Exercise 5</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../031_Numpy/">Numpy</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../032_More_numpy/">More Numpy</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Answers</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../030_NASA_MODIS_Earthdata_answers/">NASA MODIS Earthdata</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../031_Numpy_answers/">Numpy</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../032_More_numpy_answers/">More Numpy</a>
                </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Geospatial Data</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../040_GDAL_mosaicing_and_masking/">GDAL Mosaicing And Masking</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../041_GDAL_timeseries/">GDAL Timeseries</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../042_Weighted_smoothing_and_interpolation/">Weighted Smoothing And Interpolation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../043_Weighted_interpolation/">Weighted Interpolation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Answers</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../040_GDAL_mosaicing_and_masking_answers/">GDAL Mosaicing And Masking</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../041_GDAL_timeseries_answers/">GDAL Timeseries</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../043_Weighted_interpolation_answers/">Weighted Interpolation</a>
                </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Modelling</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../050_Models/">Models</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../051_Phenology_model/">Phenology Model</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Answers</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../050_Models_answers/">Models</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../051_Phenology_model_answers/">Phenology Model</a>
                </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Assessment</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../060_Groups/">Groups</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../061_Script/">Script</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../062_Part1/">Part1</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../063_Part1_code/">Part1 Code</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../064_Numpy/">Numpy</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../065_LAI/">Lai</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../066_Part2/">Part2</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Answers</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../060_Groups_answers/">Groups</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../061_Script_answers/">Script</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../064_Numpy_answers/">Numpy</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../065_LAI_answers/">Lai</a>
                </li>
    </ul>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">GEOG0111</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Array Data &raquo;</li>
        
      
    
    <li>NASA MODIS Earthdata</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/UCL-EO/geog0111/edit/master/docs/030_NASA_MODIS_Earthdata.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="030-nasa-modis-earthdata">030 NASA MODIS Earthdata</h1>
<h2 id="introduction">Introduction</h2>
<h3 id="purpose">Purpose</h3>
<p>In this notebook, we will use high-level codes from <code>geog0111</code> to familiarise ourselves with downloading and interpreting NASA MODIS datasets from <a href="https://urs.earthdata.nasa.gov"><code>NASA EarthData</code></a>. We will also be visualising these data in this notebook.</p>
<p>We will be <strong>introducing NASA MODIS land products</strong>, and viewing the MODIS LAI product as an example. This notebook should serve as an introduction to accessing similar products from Earthdata.</p>
<p>We will use <a href="https://docs.python.org/3/library/pathlib.html"><code>pathlib</code></a> and the local package <a href="geog0111/gurlpath">gurlpath</a> derived from <a href="https://github.com/chrono-meter/urlpath"><code>urlpath</code></a> to open object streams from URLs and files. </p>
<p>For further work on NASA datasets, a student might consider using an explicit <a href="https://en.wikipedia.org/wiki/Application_programming_interface">API</a> to access the data. If all you want is to get hold of some data product for some defined location and time, then you might use an API such as <a href="https://lpdaacsvc.cr.usgs.gov/appeears/">Appeears</a>.</p>
<h3 id="prerequisites">Prerequisites</h3>
<p>Since the idea of this section is to get used to the datasets, the requirement for coding is quite low. You should have some familiarity with the following:</p>
<ul>
<li><a href="../001_Notebook_use/">001 Using Notebooks</a></li>
<li><a href="../010_Python_Introduction/">010 Variables, comments and print()</a></li>
<li><a href="../011_Python_data_types/">011 Data types</a> </li>
<li><a href="024_Image_display">024 Image display</a></li>
</ul>
<h3 id="test">Test</h3>
<p>You should run a <a href="../004_Accounts/">NASA account test</a> if you have not already done so.</p>
<h2 id="modis-lai-product">MODIS LAI product</h2>
<p>To introduce geospatial processing, we will use a dataset from the MODIS LAI product over the UK. </p>
<p>The data product <a href="https://modis.gsfc.nasa.gov/data/dataprod/mod15.php">MOD15</a> LAI/FPAR has been generated from NASA MODIS sensors Terra and Aqua data since 2002. We are now in dataset collection 6 (the data version to use).</p>
<pre><code>LAI is defined as the one-sided green leaf area per unit ground area in broadleaf canopies and as half the total needle surface area per unit ground area in coniferous canopies. FPAR is the fraction of photosynthetically active radiation (400-700 nm) absorbed by green vegetation. Both variables are used for calculating surface photosynthesis, evapotranspiration, and net primary production, which in turn are used to calculate terrestrial energy, carbon, water cycle processes, and biogeochemistry of vegetation. Algorithm refinements have improved quality of retrievals and consistency with field measurements over all biomes, with a focus on woody vegetation.
</code></pre>
<p>We use such data to map and understand about the dynamics of terrestrial vegetation / carbon, for example, for climate studies.</p>
<p>The raster data are arranged in tiles, indexed by row and column, to cover the globe:</p>
<p><img alt="MODIS tiles" src="https://www.researchgate.net/profile/J_Townshend/publication/220473201/figure/fig5/AS:277546596880390@1443183673583/The-global-MODIS-Sinusoidal-tile-grid.png" /></p>
<h4 id="exercise-1">Exercise 1</h4>
<p>The pattern on the tile names is <code>hXXvYY</code> where <code>XX</code> is the horizontal coordinate and <code>YY</code> the vertical.</p>
<ul>
<li>use the map above to work out the names of the two tiles that we will need to access data over the UK</li>
<li>set the variable <code>tiles</code> to contain these two names in a list</li>
</ul>
<p>For example, for the two tiles covering Madagascar, we would set:</p>
<pre><code>tiles = ['h22v10','h22v11']
</code></pre>
<h3 id="accessing-nasa-modis-urls">Accessing NASA MODIS URLs</h3>
<p><span class="burk"><strong>Warning: The NASA data servers tend to be down for maintainance on Wednesday morning EST</strong></span></p>
<p>Although you can access MODIS datasets through the <a href="https://urs.earthdata.nasa.gov/home">NASA Earthdata</a> interface, there are many occasions that we would want to just automatically pull datasets from a server. As we note above, we could use some existing API for this, such as <a href="https://lpdaacsvc.cr.usgs.gov/appeears/">Appeears</a>, but we are aiming here at being able to ultimately develop codes that do this from a lower-level perspective. </p>
<p>Automation has many roles, and is particularly useful when you want a time series of data that might involve many files. For example, for analysing LAI or other variables over space/time) we will want to write code that pulls the time series of data. </p>
<p>If you visit the site <a href="https://e4ftl01.cr.usgs.gov/MOTA/MCD15A3H.006">https://e4ftl01.cr.usgs.gov/MOTA/MCD15A3H.006</a>, you will see 'date' style links (e.g. <code>2018.09.30</code>) through to sub-directories. </p>
<p>In these, e.g. <a href="https://e4ftl01.cr.usgs.gov/MOTA/MCD15A3H.006/2018.09.30/">https://e4ftl01.cr.usgs.gov/MOTA/MCD15A3H.006/2018.09.30/</a> you will find URLs of a set of files. </p>
<p>The files pointed to by the URLs are the MODIS MOD15 4-day composite 500 m LAI/FPAR product <a href="https://lpdaac.usgs.gov/dataset_discovery/modis/modis_products_table/mcd15a3h_v006">MCD15A3H</a>.</p>
<p>There are links to several datasets on the page, including 'quicklook files' that are jpeg format images of the datasets, e.g.:</p>
<p><img alt="MCD15A3H.A2018273.h17v03" src="https://e4ftl01.cr.usgs.gov/MOTA/MCD15A3H.006/2018.09.30/BROWSE.MCD15A3H.A2018273.h17v03.006.2018278143630.1.jpg" /></p>
<p>as well as <code>xml</code> files and <code>hdf</code> datasets. </p>
<h3 id="data-products">Data Products</h3>
<p>If we look at the dataserver we have specified <a href="https://e4ftl01.cr.usgs.gov">https://e4ftl01.cr.usgs.gov</a>, we will see that a number of sub-directories exist. Each of these 'server directories' points to a different data stream:</p>
<pre><code>[DIR] ASTT/                   2019-08-05 07:54    -   
[DIR] COMMUNITY/              2020-06-02 08:45    -   
[DIR] ECOSTRESS/              2020-04-09 10:30    -   
[DIR] GEDI/                   2020-02-10 09:58    -   
[DIR] MEASURES/               2020-03-17 10:55    -   
[DIR] MOLA/                   2020-06-01 09:20    -   
[DIR] MOLT/                   2020-04-14 08:06    -   
[DIR] MOTA/                   2019-12-27 06:49    -   
[DIR] VIIRS/                  2020-06-23 10:26    -
</code></pre>
<p>For example, we might notice <a href="https://e4ftl01.cr.usgs.gov/VIIRS">VIIRS</a> which takes us to the <a href="https://viirsland.gsfc.nasa.gov">VIIRS data products</a>, or <a href="https://e4ftl01.cr.usgs.gov/GEDI">GEDI</a> <a href="https://gedi.umd.edu/">spaceborne lidar</a> data. Each of these data streams will have their own properties that we need to appreciate before using them.</p>
<h3 id="mota">MOTA</h3>
<p>The URL we have used above, <a href="https://e4ftl01.cr.usgs.gov/MOTA/MCD15A3H.006/2018.09.30/">https://e4ftl01.cr.usgs.gov/MOTA/MCD15A3H.006/2018.09.30/</a> starts with a call to the server directory <code>MOTA</code>, so we can think of <code>https://e4ftl01.cr.usgs.gov/MOTA</code> as the base level URL.</p>
<p>MOTA refers to combined MODIS Terra and Aqua datasets. Similarly, MOLA and MOLT refer to datasets generated from single MODIS sensors of Aqua and Terra, respectively.</p>
<p>The rest of the directory information <code>MCD15A3H.006/2018.09.30</code> tells us:</p>
<ul>
<li>the product name <code>MCD15A3H</code></li>
<li>the product version <code>006</code></li>
<li>the date of the dataset <code>2018.09.30</code></li>
</ul>
<p>There are several ways we could specify the date information. The most 'human readable' is probably <code>YYYY.MM.DD</code> as given here, but we may also use day of year. Recall from <a href="../023_Plotting/#datetime">023 Plotting</a> how to convert date formats.</p>
<p>We will mainly use <a href="../geog0111/im_display.py"><code>geog0111.im_display</code></a> to do simple image plots. This is essentially the same as the code you have developed in <a href="../024_Image_display/#Exercise-2">an exercise</a>.</p>
<p>If we look at the <a href="https://lpdaac.usgs.gov/products/mcd15a3hv006/">product specification page</a> for <code>MCD15A3H</code> we see that the data product has multiple data layers. In the case of MCD15A3H, this is:</p>
<table>
<thead>
<tr>
<th align="center">SDS Name</th>
<th align="center">Description</th>
<th align="center">Units</th>
<th align="center">Data Type</th>
<th align="center">Fill Value</th>
<th align="center">No Data Value</th>
<th align="center">Valid Range</th>
<th>Scale Factor</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Fpar_500m</td>
<td align="center">Fraction of Photosynthetically Active Radiation</td>
<td align="center">Percent</td>
<td align="center">8-bit unsigned integer</td>
<td align="center">249 to 255</td>
<td align="center">N/A</td>
<td align="center">0 to 100</td>
<td>0.01</td>
</tr>
<tr>
<td align="center">Lai_500m</td>
<td align="center">Leaf Area Index</td>
<td align="center">m²/m²</td>
<td align="center">8-bit unsigned integer</td>
<td align="center">249 to 255</td>
<td align="center">N/A</td>
<td align="center">0 to 100</td>
<td>0.1</td>
</tr>
<tr>
<td align="center">FparLai_QC</td>
<td align="center">Quality for  FPAR and LAI</td>
<td align="center">Class Flag</td>
<td align="center">8-bit unsigned integer</td>
<td align="center">255</td>
<td align="center">N/A</td>
<td align="center">0 to 254</td>
<td>N/A</td>
</tr>
<tr>
<td align="center">FparExtra_QC</td>
<td align="center">Extra detail Quality for  FPAR and LAI</td>
<td align="center">Class Flag</td>
<td align="center">8-bit unsigned integer</td>
<td align="center">255</td>
<td align="center">N/A</td>
<td align="center">0 to 254</td>
<td>N/A</td>
</tr>
<tr>
<td align="center">FparStdDev_500m</td>
<td align="center">Standard deviation of  FPAR</td>
<td align="center">Percent</td>
<td align="center">8-bit unsigned integer</td>
<td align="center">248 to 255</td>
<td align="center">N/A</td>
<td align="center">0 to 100</td>
<td>0.01</td>
</tr>
<tr>
<td align="center">LaiStdDev_500m</td>
<td align="center">Standard deviation of LAI</td>
<td align="center">m²/m²</td>
<td align="center">8-bit unsigned integer</td>
<td align="center">248 to 255</td>
<td align="center">N/A</td>
<td align="center">0 to 100</td>
<td>0.1</td>
</tr>
</tbody>
</table>
<p>We will use a simple recipe for accessing a dataset and plotting it. All examples below will follow the same pattern.</p>
<p>First, we use the <code>Modis</code> class in <code>geog0111.modis</code> to get the dataset. Recall from <a href="024_Image_display">024 Image display</a> that many of these datasets are cached on the system for you. If it takes a long time to retrieve a dataset, it is probably because you are downloading it, rather than using a cached copy. If it is Wednesday afternoon UK time, you will not be able to download new datasets, and can only use cached copies, as the NASA server is down for maintenance.</p>
<p>Notice that the LAI data have a valid range 0 to 100, and that a scale factor of 0.1 must be applied to the datas to interpret as LAI.</p>
<pre><code class="python">from geog0111.modis import Modis
#######################
# specify what we want
# in a dictionary
#######################
# UK tiles

kwargs = {
    'tile'      :    ['h17v03', 'h17v04', 'h18v03', 'h18v04'],
    'product'   :    'MCD15A3H',
    'sds'       :    'Lai_500m',
}
modis = Modis(**kwargs)
# specify day of year (DOY) and year
data_MCD15A3H = modis.get_data(2019,doy=1+4*10)
</code></pre>

<pre><code class="python">from geog0111.im_display import im_display

im_display(data_MCD15A3H,['Lai_500m'],x_size=16,y_size=8,vmax=100)
</code></pre>

<p><img alt="png" src="../030_NASA_MODIS_Earthdata_files/030_NASA_MODIS_Earthdata_9_0.png" /></p>
<h3 id="masking">masking</h3>
<p>We can see from the  <a href="https://lpdaac.usgs.gov/products/mcd15a3hv006/">product specification page</a> for <code>MCD15A3H</code> that values above <code>100</code> for <code>Lai_500m</code> are invalid. In addition, a scale factor of 0.1 should be applied.</p>
<p>We will learn more of this later, but for now, note that we can use code such as the following to apply the scaling factor and mask invalid numbers. We need to import the <code>numpy</code> package for this first (<code>import numpy as np</code>).</p>
<pre><code class="python">from geog0111.modis import Modis

kwargs = {
    'tile'      :    ['h17v03', 'h17v04', 'h18v03', 'h18v04'],
    'product'   :    'MCD15A3H',
    'sds'       :    'Lai_500m',
}
modis = Modis(**kwargs)

# repull dataset
data_MCD15A3H = modis.get_data(2019,doy=1+4*10)
</code></pre>

<pre><code class="python">import numpy as np
# multiply by scale
scale = 0.1
ds = data_MCD15A3H['Lai_500m'] * scale
# mask invalid by setting to 
ds[ds&gt;100 * scale] = np.nan

# load back into data_MCD15A3H
data_MCD15A3H['Lai_500m'] = ds

# plot
im_display(data_MCD15A3H,['Lai_500m'],x_size=16,y_size=8)
</code></pre>

<p><img alt="png" src="../030_NASA_MODIS_Earthdata_files/030_NASA_MODIS_Earthdata_12_0.png" /></p>
<p>The dataset, being a measurement, is not spatially complete. This is because of clouds and other factors meaning that the algorithm to produce LAI could not run at that time. It is very common that you will find geospatial datasets have missing values. We will learn later on when and how we might fill these gaps.</p>
<h4 id="exercise-2-mask-invalid-data">Exercise 2: mask invalid data</h4>
<ul>
<li>
<p>write a function called <code>data_mask</code> that is given:</p>
<ul>
<li>a data dictionary</li>
<li>a list of sds strings</li>
<li>a list of scale factors</li>
<li>a list of upper threshold values</li>
<li>a list of lower threshold values
  and returns the dictionary with the scaled and masked datasets </li>
</ul>
</li>
<li>
<p>plot both <code>Lai_500m</code> and <code>LaiStdDev_500m</code> side-by-side. You should apply appropriate scaling factors and masking as above.</p>
</li>
</ul>
<h2 id="burned-area-dataset-mcd64a1">Burned area dataset <code>MCD64A1</code></h2>
<p>We can use the same codes to access different MODIS datasets. For example the monthly <a href="https://lpdaac.usgs.gov/products/mcd64a1v006/"><code>MCD64A1</code></a> product:</p>
<p><a href="https://lpdaac.usgs.gov/products/mcd64a1v006/"><img alt="MCD15A3H" src="../images/MCD15A3H.png" /></a></p>
<p>For the <code>Burn Date</code> field, values of -2 to 0 are invalid. We can visualise this with code as above, but first we need to get the day of year for the month we want. Recall from <a href="../023_Plotting/#datetime">023 Plotting</a> that we can use <code>datetime</code> for this. We do this by working out the difference between the day of the month in question and the 31st day of December for the previous year.</p>
<pre><code class="python">from datetime import datetime

year = 2019
day = 1
for month in range(1,13):
    doy = (datetime(year,month,day) - datetime(year-1,12,31)).days
    print(f'1st of {month:&lt;2d} is doy {doy}')
</code></pre>

<pre><code>1st of 1  is doy 1
1st of 2  is doy 32
1st of 3  is doy 60
1st of 4  is doy 91
1st of 5  is doy 121
1st of 6  is doy 152
1st of 7  is doy 182
1st of 8  is doy 213
1st of 9  is doy 244
1st of 10 is doy 274
1st of 11 is doy 305
1st of 12 is doy 335
</code></pre>
<h4 id="exercise-3">Exercise 3</h4>
<ul>
<li>write a function called <code>get_doy</code> that is given the year, month and day integer and returns the day of year</li>
<li>test it</li>
</ul>
<p>We now simply need to encode any scale factors or invalidity thresholds, and we can plot the dataset:</p>
<pre><code class="python">from geog0111.modis import Modis
from geog0111.im_display import im_display
from geog0111.data_mask import data_mask
from geog0111.get_doy import get_doy

# h22v10 is Madagascar
kwargs = {
    'tile'      :    ['h22v10'],
    'product'   :    'MCD64A1',
    'sds'       :    ['Burn Date'],
}

year  = 2019
month = 6

doy = get_doy(year,month,1)
print(doy)
# get the data
modis = Modis(**kwargs)
# specify day of year (DOY) and year
data_MCD64A1 = modis.get_data(2019,doy=doy)

</code></pre>

<pre><code>152
</code></pre>
<pre><code class="python">scale   = [1]
uthresh = [200]
lthresh = [0]

data_MCD64A1 = data_mask(data_MCD64A1,kwargs['sds'],scale,uthresh,lthresh)

# have to take sub-area to see anything here:
# define row and column min/max with r=[1500,2000],c=[1000,1500]
im_display(data_MCD64A1,kwargs['sds'],\
           x_size=10,y_size=8,\
           r=[1800,2000],c=[1000,1200])
</code></pre>

<p><img alt="png" src="../030_NASA_MODIS_Earthdata_files/030_NASA_MODIS_Earthdata_20_0.png" /></p>
<h2 id="snow">Snow</h2>
<p>There are two MODIS daily snow cover datasets: <a href="https://modis-snow-ice.gsfc.nasa.gov/?c=MOD10A1"><code>MOD10A1</code> and <code>MYD10A1</code></a> for data from the MODIS Terra and Aqua sensors, respectively. The field <a href="https://developers.google.com/earth-engine/datasets/catalog/MODIS_006_MOD10A1"><code>NDSI_Snow_Cover</code></a> has valid values in the range 0 to 100.</p>
<pre><code class="python">from geog0111.modis import Modis
from geog0111.im_display import im_display
from geog0111.data_mask import data_mask
from geog0111.get_doy import get_doy

kwargs = {
    'tile'      :    ['h19v03'],
    'product'   :    'MOD10A1',
    'sds'       :     ['NDSI_Snow_Cover']
}

# look in the winter
year  = 2019
month = 12
day = 1

scale   = [1]
uthresh = [101]
lthresh = [-1]
sds     = kwargs['sds']

doy = get_doy(year,month,day)
print(doy)
# get the data
modis = Modis(**kwargs)
# specify day of year (DOY) and year
data_MOD10A1 = modis.get_data(2019,doy=doy)
data_MOD10A1 = data_mask(data_MOD10A1,sds,scale,uthresh,lthresh)
</code></pre>

<pre><code>335
</code></pre>
<pre><code class="python"># have to take sub-area to see anything here:
# define row and column min/max with r=[1500,2000],c=[1000,1500]
im_display(data_MOD10A1,kwargs['sds'],\
           x_size=10,y_size=8,colourmap='gray')
</code></pre>

<p><img alt="png" src="../030_NASA_MODIS_Earthdata_files/030_NASA_MODIS_Earthdata_23_0.png" /></p>
<h2 id="land-cover-dataset-mcd12q1">Land Cover dataset <code>MCD12Q1</code></h2>
<p>One of the MODIS land cover products is <code>MCD12Q1</code>. We briefly examined this product in the previous session, but can take the chance now to explore it further. The datasets are yearly, given for <code>doy</code> 1. Details of the product can be found at the product page (<code>MCD12Q1</code>)[https://lpdaac.usgs.gov/products/mcd12q1v006/].</p>
<p>We previously developed a code <a href="../geog0111/plot_lc.py"><code>get_lc</code></a> to set up the colourmaps and plot the <code>LC_Type1</code> for a given year and set of tiles. This is the <code>Land Cover Type 1: Annual International Geosphere-Biosphere Programme (IGBP) classification</code>. </p>
<pre><code class="python">from geog0111.plot_lc import plot_lc
from geog0111.modis import Modis
# Madagascar
year,tiles = 2018,['h22v10']

# ensure tiles is a list
kwargs = {
    'tile'      :    list(tiles),
    'product'   :    'MCD12Q1',
    'sds'       :    ['LC_Type1']
}
# get the data
modis = Modis(**kwargs)
# specify day of year (DOY) and year
data_MCD12Q1 = modis.get_data(year,doy=1)
# the data we want here
plot_lc(data_MCD12Q1['LC_Type1'])
</code></pre>

<p><img alt="png" src="../030_NASA_MODIS_Earthdata_files/030_NASA_MODIS_Earthdata_25_0.png" /></p>
<h4 id="exercise-5">Exercise 5</h4>
<ul>
<li>Explore the MODIS datasets in your own time, and get to know the datasets they contain, along with the scaling factors and other interpretation information. Note that if we have not already downloaded particular datasets into the cache, it  may take a short time for them to download and load.</li>
</ul>
<h1 id="summary">Summary</h1>
<p>In these notes, we have introduced the characteristics of MODIS data products, and learned how to specify, access, and display them for a number of datasets. You will have accessed a number of products under a number of conditions in the exercises, but you are encouraged to explore this further.</p>
<p>The main item to do with using data products of this sort, that we haven't covered yet, is the interpretation of Quality Assurance (QA) data. This is often packed information into bits, and can be a little tricky at first. However, as with above, once you have a little familiarisation with a few cases, you will be able to apply this more widely.</p>
<p>You should spend some time going through the various links to explore the different datasets, and try out the exercises above for various products. The familiarity you gain from this will help when it comes to building our own codes later on.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../031_Numpy/" class="btn btn-neutral float-right" title="Numpy">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../024_Image_display_answers/" class="btn btn-neutral" title="Image Display"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/UCL-EO/geog0111/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../024_Image_display_answers/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../031_Numpy/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
